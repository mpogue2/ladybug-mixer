; PlatformIO Project Configuration File for STC8G1K08
;
; Board: STC8G1K08A
; Platform: Intel MCS-51 (8051)
; TSSOP-20 VERSION OF STC8G1K08 MICROCONTROLLER

[env:stc8g1k08a]
platform = intel_mcs51
board = STC8G1K08                                                                               
framework =

; Use SDCC compiler
build_flags =
    -D__SDCC__
    -D__CONF_MCU_MODEL=MCU_MODEL_STC8G1K08
    -D__CONF_FOSC=17500000UL
    -D__CONF_CLKDIV=0x04    ; STEP 2: Clock divider = 4 (4.375 MHz)
    -mmcs51
    --std-sdcc11
    --opt-code-size
    -DSTC8G1K08A

; Upload configuration for stc8prog
; Set upload_port to your serial port device
; macOS: /dev/cu.usbserial-* or /dev/tty.usbserial-*
; Linux: /dev/ttyUSB* or /dev/ttyACM*
; Windows: COM*
upload_port = /dev/cu.usbserial-BG01P000
upload_speed = 115200
upload_protocol = custom

; upload_flags =
;     -p$UPLOAD_PORT
;     -s$UPLOAD_SPEED
;     -e
;     -r5
;upload_command = ${platformio.packages_dir}/tool-stc8prog/stc8prog $UPLOAD_FLAGS -f $SOURCE

upload_flags =
    -Arts
    -a
    -oeeprom_erase_enabled=False
    -Pstc8g
    -t17500
    -p$UPLOAD_PORT
    -b$UPLOAD_SPEED

upload_command = /usr/local/bin/stcgal $UPLOAD_FLAGS $SOURCE

; Monitor configuration
monitor_speed = 115200
monitor_port = /dev/cu.usbserial-BG01P000
